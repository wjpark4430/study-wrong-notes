# 📌 컬럼 반정규화(De-normalization) 오답노트

| 항목       | 설명                                                      |
| -------- | ------------------------------------------------------- |
| 반정규화 정의  | 성능 향상이나 업무 처리 편의성을 위해 정규화된 데이터 구조를 **일부러 중복 또는 분해**하는 것 |
| 목적       | 조회 성능 개선, 조인 비용 감소, 특정 업무 처리 효율화                        |
| 주요 기법 예시 | 중복 컬럼 추가, 파생 컬럼 추가, 이력 테이블 분리, FK 속성 중복 저장 등            |

---

## 문제

![34-6 번 문제](../images/34-6.png)

---

## ❌ 오답 선택: 3번

> `이력테이블에 기능 칼럼을 추가한다 - 최신값을 처리하는 이력의 특성을 고려하여 기능성 칼럼을 추가한다`

* **이력 테이블**에 기능성 컬럼(예: 유효 여부, 최신 여부 등)을 추가하는 것은 실제 반정규화에서 **빈번하게 사용되는 방법 중 하나**임.
* 특히 `is_current`, `end_date`, `flag` 같은 컬럼은 **이력 데이터에서 최신값을 빠르게 조회**하기 위해 자주 쓰임.

```sql
-- 최신 이력만 조회하기 위해 is_current 컬럼 활용
SELECT *
FROM emp_history
WHERE emp_id = 1001
AND is_current = 'Y';
```

✔ 따라서 3번은 **적절한 반정규화 기법**으로 볼 수 있어 **정답이 아님**.

---

## ✅ 정답: 4번

> `FK에 대한 속성을 추가한다 - FK관계에 해당하는 속성을 추가하여 조인 성능을 높인다`


* 외래 키(FK)에 해당하는 속성은 이미 **관계로 존재**하며, 이를 다시 컬럼으로 중복 저장하는 것은 **무결성 및 정합성 문제**를 유발할 수 있음.
* 조인 성능을 개선한다는 목적이라면 **인덱스나 적절한 설계 변경**으로 해결해야지, FK 속성을 **중복으로 저장하는 건 권장되지 않음**.

---

## 추가 설명 & 복습 포인트

| 개념              | 설명                                              |
| --------------- | ----------------------------------------------- |
| 중복 컬럼 추가        | 조인 줄이기 위해 동일한 컬럼 여러 테이블에 저장 (성능 ↑, 정합성 ↓ 위험 있음) |
| 파생 컬럼 추가        | 미리 계산한 값을 저장해 쿼리 속도 향상 (`총액`, `상태`, `나이` 등)     |
| 이력 테이블 기능 컬럼 추가 | `is_current`, `version_no` 등 이력 관리용 컬럼 추가       |
| FK 속성 중복 저장     | 일반적으로 **지양되는 방식** (무결성 유지 어려움)                  |

---

## 느낀 점

* **이력 테이블의 최신 값 판별을 위한 기능 컬럼 추가는 대표적인 반정규화 기법**임을 명확히 알 수 있었음
* 반정규화는 성능 최적화를 위한 중요한 기법이지만, **정합성과 관리 측면에서 트레이드오프**가 있다는 점도 함께 고려해야 함